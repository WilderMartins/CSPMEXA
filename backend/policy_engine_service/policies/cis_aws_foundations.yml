policies:
  - id: "CIS-AWS-1.1"
    provider: "aws"
    service: "iam"
    severity: "CRITICAL"
    title: "MFA para usuário Root"
    description: "O MFA (Multi-Factor Authentication) deve estar habilitado para o usuário 'root' da conta AWS para aumentar a segurança."
    recommendation: "Habilite o MFA para o usuário root no console do IAM."
    check_function: "check_root_mfa_enabled"

  - id: "CIS-AWS-2.2"
    provider: "aws"
    service: "cloudtrail"
    severity: "HIGH"
    title: "CloudTrail habilitado em todas as regiões"
    description: "Pelo menos um trail do AWS CloudTrail deve ser configurado para receber eventos de log de todas as regiões."
    recommendation: "Crie um novo trail do CloudTrail e marque a opção 'Apply trail to all regions' ou modifique um trail existente."
    check_function: "check_cloudtrail_multi_region"

  - id: "CIS-AWS-2.3"
    provider: "aws"
    service: "cloudtrail"
    severity: "MEDIUM"
    title: "Validação de arquivos de log do CloudTrail habilitada"
    description: "A validação da integridade dos arquivos de log do CloudTrail deve estar habilitada para garantir que os logs não foram alterados."
    recommendation: "Habilite a validação de arquivos de log nas configurações do seu trail do CloudTrail."
    check_function: "check_cloudtrail_log_file_validation"
